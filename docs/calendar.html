<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>竞赛日历 · Contest Radar</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="#6750A4">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">

  <style>
    :root {
      --primary: #6750A4;
      --primary-light: #D0BCFF;
    }
    body {
      font-family: 'Inter', -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);
      min-height: 100vh;
    }
    body::before{
      content:"";
      position:fixed;
      inset:0 0 auto 0;
      height:340px;
      background:linear-gradient(135deg,var(--primary) 0%,var(--primary-light) 100%);
      border-radius:0 0 40px 40px;
      z-index:-1;
    }
    @media (max-width: 991.98px){
      body::before{height:540px;} /* 下移背景防止遮挡 */
      .navbar-collapse.show{
        background:rgba(255,255,255,0.95)!important;
      }
    }
    .navbar{
      background:rgba(255,255,255,0.92);
      backdrop-filter:blur(10px);
      box-shadow:0 4px 18px rgba(0,0,0,0.05);
    }
    /* FullCalendar tweaks */
    .fc-daygrid-event{
      border-radius:.35rem;
      padding:2px 4px;
      font-size:.75rem;
    }
    .fc .fc-day-today{
      background:rgba(103,80,164,.08);
    }
    .fc-scrollgrid{
      border-radius:1.25rem;
      overflow:hidden;
    }
    /* Glass card */
    .glass-card{
      background:rgba(255,255,255,0.45);
      backdrop-filter:blur(12px);
      border:1px solid rgba(255,255,255,0.4);
      border-radius:1.25rem;
      box-shadow:0 6px 24px rgba(0,0,0,0.08);
    }
    /* Timeline */
    .timeline{border-left:2px solid var(--primary-light);padding-left:1.75rem;list-style:none}
    .timeline li{position:relative;margin-bottom:1.5rem}
    .timeline li::before{
      content:"";
      position:absolute;left:-12px;top:4px;
      width:12px;height:12px;border-radius:50%;
      background:var(--primary);border:2px solid #fff;
      box-shadow:0 0 0 2px var(--primary-light);
    }
    /* Mobile nav override (white) */
    @media (max-width: 991.98px){
      .navbar-collapse.show{background:rgba(255,255,255,0.95)!important;}
    }
  


  




  
/* ---- 2025‑07‑28 calendar list layout ---- */
@media (min-width:0){
  #calendar{display:none!important;}
  .col-lg-8{display:none!important;}
  .col-lg-4{
    flex:0 0 100%!important;
    max-width:700px!important;
    margin:0 auto!important;
  }
  .glass-card{background:rgba(255,255,255,0.9)!important;}
}
/* ---------------------------------------- */

  
/* ---- CALENDAR LIST POSITION (2025‑07‑28) ---- */
@media (min-width:0){
  .glass-card{margin-top:100px!important;}
}

  
/* Navbar */
    .navbar {
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 15px rgba(0,0,0,0.05);
      padding: 15px 0; position: sticky; top: 0; z-index: 1000;
    }
    .navbar-brand { font-weight:700; color: var(--primary); display:flex; align-items:center; gap:10px; }
    .nav-link {
      font-weight:500;
      transition: var(--transition);
      padding:8px 15px !important;
      border-radius:50px;
    }
    .nav-link:hover, .nav-link.active {
      background: rgba(103,80,164,0.1);
      color: var(--primary);
    }

    /* Hero */
    .hero-section { padding:80px 0 60px; color:white; text-align:center; }
    .hero-section h1 { font-weight:800; font-size:3.2rem; margin-bottom:15px; text-shadow:0 2px 10px rgba(0,0,0,0.15);}
    .hero-section p {
      font-size:1.25rem; max-width:700px; margin:0 auto 25px; opacity:0.9;
    }

    /* Stats */
    .stats-container { display:flex; gap:15px; justify-content:center; flex-wrap:wrap; margin-top:20px; }
    .stat-badge {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      border-radius:50px;
      padding:8px 20px;
      display:flex;
      align-items:center;
      gap:8px;
      font-size:0.95rem;
      font-weight:500;
    }

    /* Controls */
    .controls-section {
      background:white;
      border-radius:20px;
      box-shadow:var(--card-shadow);
      padding:25px;
      margin:-30px auto 40px;
      max-width:1200px;
      position:relative;
      z-index:10;
    }
    .filter-container { display:flex; gap:15px; flex-wrap:wrap; justify-content:center; }

    .filter-btn {
      padding:10px 25px;
      border-radius:50px;
      font-weight:500;
      background: var(--light);
      border: none;
      transition: var(--transition);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .filter-btn.active,
    .filter-btn:hover {
      color: white;
      box-shadow: 0 5px 15px rgba(103,80,164,0.3);
    }
    /* 只有 hover / active 时变色 */
    .filter-btn[data-filter="all"].active,
    .filter-btn[data-filter="all"]:hover {
      background: var(--primary);
    }
    .filter-btn[data-filter="Codeforces"].active,
    .filter-btn[data-filter="Codeforces"]:hover {
      background: var(--info);
    }
    .filter-btn[data-filter="牛客"].active,
    .filter-btn[data-filter="牛客"]:hover {
      background: var(--success);
    }
    .filter-btn[data-filter="AtCoder"].active,
    .filter-btn[data-filter="AtCoder"]:hover {
      background: var(--danger);
    }
    .filter-btn[data-filter="洛谷"].active,
    .filter-btn[data-filter="洛谷"]:hover {
      background: var(--warning);
    }
    .filter-btn[data-filter="力扣"].active,
    .filter-btn[data-filter="力扣"]:hover {
      background: #FF5722;
    }

    /* Contest Cards */
    .contest-grid {
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(350px,1fr));
      gap:25px;
      max-width:1300px;
      margin:0 auto;
      padding:0 20px 40px;
    }
    .contest-card {
      background:white;
      border-radius:20px;
      overflow:hidden;
      box-shadow:var(--card-shadow);
      transition:var(--transition);
      display:flex;
      flex-direction:column;
      height:100%;
    }
    .contest-card:hover {
      transform:translateY(-10px);
      box-shadow:0 15px 30px rgba(0,0,0,0.12);
    }
    .card-header {
      padding:20px;
      display:flex;
      align-items:center;
      gap:15px;
    }
    .platform-img {
      width:50px; height:50px; border-radius:15px; object-fit:cover; flex-shrink:0;
    }
    .platform-name {
      font-weight:700;
      font-size:1.1rem;
      margin-bottom:3px;
    }
    .platform-name[data-site="Codeforces"] { color: var(--info); }
    .platform-name[data-site="牛客"]       { color: var(--success); }
    .platform-name[data-site="AtCoder"]    { color: var(--danger); }
    .platform-name[data-site="洛谷"]       { color: var(--warning); }
    .platform-name[data-site="力扣"]       { color: #FF5722; }

    .card-body { padding:0 20px 20px; flex-grow:1; display:flex; flex-direction:column; }
    .contest-name { font-weight:600; font-size:1.25rem; margin-bottom:15px; line-height:1.4; flex-grow:1; }
    .contest-time {
      background: var(--light);
      border-radius:15px;
      padding:15px;
      margin-top:15px;
    }
    .time-label {
      font-size:0.85rem;
      font-weight:500;
      color:#666;
      margin-bottom:5px;
      display:flex; align-items:center; gap:5px;
    }
    .time-value {
      font-weight:600;
      font-size:1.1rem;
      margin-bottom:10px;
    }
    .countdown {
      background: rgba(103,80,164,0.1);
      color: var(--primary);
      padding:8px 15px;
      border-radius:50px;
      font-weight:600;
      font-size:0.9rem;
      display:inline-block;
      margin-top:5px;
    }
    .card-footer {
      padding:15px 20px;
      background: rgba(103,80,164,0.03);
      border-top:1px solid rgba(0,0,0,0.05);
      display:flex; justify-content:space-between;
    }
    .days-away { font-weight:600; font-size:0.9rem; color:#666; }

    /* 占位符头像，只对 .platform-img-placeholder 生效 */
    .platform-img-placeholder {
      width:50px; height:50px; border-radius:15px;
      display:flex; align-items:center; justify-content:center;
      font-size:1.6rem; color:white; flex-shrink:0;
    }
    .platform-img-placeholder[data-site="Codeforces"] { background: var(--info); }
    .platform-img-placeholder[data-site="牛客"]       { background: var(--success); }
    .platform-img-placeholder[data-site="AtCoder"]    { background: var(--danger); }
    .platform-img-placeholder[data-site="洛谷"]       { background: var(--warning); }
    .platform-img-placeholder[data-site="力扣"]       { background: #FF5722; }

    /* Footer & Responsive 略... 保持原样 */
  
    /* Mobile nav background – white */
    @media (max-width: 991.98px){
      .navbar-collapse.show{
        background:rgba(255,255,255,0.95)!important;
      }
    }
    

    /* Mobile nav background – white */
    @media (max-width: 991.98px){
      .navbar-collapse.show{
        background:rgba(255,255,255,0.95)!important;
      }
    }
</style>
  <link rel="stylesheet" href="nav.css">
</head>
<body>

<nav class="navbar navbar-expand-lg fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <i class="bi bi-radar"></i>
        <span>Contest&nbsp;Radar</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link " href="index.html">首页</a></li>
<li class="nav-item"><a class="nav-link " href="calendar.html">竞赛日历</a></li>
<li class="nav-item"><a class="nav-link " href="about.html">关于</a></li>
        </ul>
      </div>
    </div>
  </nav>

<div class="container mt-4 pb-5">
  <div class="row g-4">
    <div class="col-lg-8">
      <div class="glass-card p-3">
        <div id="calendar"></div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="glass-card p-4 h-100">
        <h6 class="fw-bold mb-3"><i class="bi bi-hourglass-split me-1"></i>即将开始</h6>
        <ul class="timeline mb-0" id="upcomingList"></ul>
      </div>
    </div>
  </div>
</div>

<!-- Modal 省略，可复用之前版本，如无需可删除 -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script>
async function loadData(){
  const res = await fetch('contests.json', { cache: 'no-store' });
  if (!res.ok) throw new Error('数据加载失败');
  const payload = await res.json();
  return payload.contests || [];
}

function setActiveNav() {
  const path = location.pathname.split('/').pop() || 'calendar.html';
  document.querySelectorAll('.nav-link').forEach(link => {
    if (link.getAttribute('href') === path) {
      link.classList.add('active');
    }
  });
}

function buildUpcoming(contests){
  const list = document.getElementById('upcomingList');
  if (!list) return;
  list.innerHTML = '';
  const upcoming = contests
    .filter(c => new Date(c.start) >= new Date())
    .sort((a, b) => new Date(a.start) - new Date(b.start));
  if (!upcoming.length){
    const li = document.createElement('li');
    li.innerHTML = '<span class="text-muted">暂无近期赛事</span>';
    list.appendChild(li);
    return;
  }
  upcoming.forEach(c => {
    const li = document.createElement('li');
    const st = new Date(c.start);
    const mm = String(st.getMonth()+1).padStart(2,'0');
    const dd = String(st.getDate()).padStart(2,'0');
    const hh = String(st.getHours()).padStart(2,'0');
    const mi = String(st.getMinutes()).padStart(2,'0');
    li.innerHTML = `
      <div class="d-flex justify-content-between flex-wrap">
        <span class="fw-semibold">${c.site} | ${c.name}</span>
        <small class="text-muted">${mm}-${dd} ${hh}:${mi}</small>
      </div>
    `;
    list.appendChild(li);
  });
}

loadData().then(contests=>{
  const cal = new FullCalendar.Calendar(document.getElementById('calendar'),{
    locale:'zh-cn',
    themeSystem:'bootstrap5',
    initialView:'dayGridMonth',
    firstDay:1,
    headerToolbar:{left:'prev,next today',center:'title',right:'dayGridMonth,timeGridWeek,listMonth'},
    height:'auto',
    events:contests.map(c=>({title:`${c.site} | ${c.name}`,start:c.start,url:c.url}))
  });
  cal.render();
  buildUpcoming(contests);
}).catch(err=>{
  const list = document.getElementById('upcomingList');
  if (list) list.innerHTML = `<li><span class="text-muted">${err.message || '数据加载失败'}</span></li>`;
});

document.addEventListener('DOMContentLoaded', ()=>{
  setActiveNav();
});
</script>
</body>
</html>
